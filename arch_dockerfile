# The container is uses to practise coding.

# Base on Arch Linux
FROM archlinux

# Creator is me.
MAINTAINER chensy<chensy.lin@outlook.com>

ENV HOME /home/chensy

# Add volume.
VOLUME $HOME/extra

# add pacman server origin.
RUN echo "Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch" >> /etc/pacman.d/mirrorlist \
		&& echo "Server = http://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch" >> /etc/pacman.d/mirrorlist \
		&& echo "Server = http://mirrors.tuna.tsinghua.edu.cn/archlinuxarm/$arch/$repo" >> /etc/pacman.d/mirrorlist \
		&& echo "Server = http://mirrors.ustc.edu.cn/archlinuxarm/$arch/$repo" >> /etc/pacman.d/mirrorlist

# Install common tools.
RUN pacman -Syu --noconfirm \
		&& pacman -Syy --noconfirm \
				net-tools \
				neovim \
				git \
				base-devel \
				intel-ucode \
				curl \
				vi \
				zsh

# Edit hostname.
RUN echo "Arch" > /etc/hostname

#  set passwd for root.
RUN echo "root:arthurs000" | chpasswd 

# Create user and group.
RUN groupadd lin \
		&& useradd -s /bin/zsh -g lin -m chensy \
		&& echo "chensy:001993" | chpasswd

COPY ./config-* $HOME/configureFiles/
COPY ./start.sh $HOME/start.sh

# Manual install oh-my-zsh and plugins.
RUN cd $HOME \
		&& git clone https://github.com/ohmyzsh/ohmyzsh.git $HOME/.oh-my-zsh \
		&& git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $HOME/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting \
		&& git clone https://github.com/zsh-users/zsh-autosuggestions $HOME/.oh-my-zsh/custom/plugins/zsh-autosuggestions \
		&& cp $HOME/configureFiles/config-zshrc $HOME/.zshrc

RUN chmod 775 $HOME/start.sh \
		&& chown -R chensy:lin $HOME

WORKDIR $HOME

USER chensy

